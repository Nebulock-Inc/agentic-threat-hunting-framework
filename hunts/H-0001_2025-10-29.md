# H-0001 | SSH Brute Force Detection | 2025-10-29

**Status**: Completed

## Hypothesis

Adversaries use automated tools to attempt SSH authentication against Linux servers, generating patterns of failed login attempts that indicate brute force activity.

## Data Source

**Query**: `queries/H-0001.spl` (refined version - see below)
**Time Range**: -24h to now
**Runtime**: 3.8 seconds
**Rows Examined**: 7,219
**Rows Returned**: 12

**Query Modifications from Previous Run:**
```spl
# Added IP filtering
| search NOT (src_ip="10.*" OR src_ip="172.16.*" OR src_ip="192.168.*")

# Increased threshold
| where failed_attempts > 10  # (was >5)
```

## Findings

Refined query reduced results from 47 to 12 sources - all external IPs with sustained attack patterns.

**Key Observations:**
- All 12 sources show >10 failed attempts (higher threshold eliminated scanner noise)
- 8 sources specifically target service accounts (jenkins, gitlab, ansible)
- 4 sources attempt common usernames only (root, admin, test)
- Average attempt rate: 8 per minute (more deliberate than previous scanner traffic)
- No sources escalated to successful authentication

**Evidence:**
- All flagged IPs were already blocked from previous week's action
- No new threat actors identified this week
- Service account targeting suggests some reconnaissance of our environment occurred

## Analysis

The query refinements successfully reduced noise by 75% while maintaining detection capability. However, all suspicious IPs this week were already known and blocked.

**True Positives:**
- 12 confirmed brute force attempts (all previously identified and mitigated)

**False Positives:**
- None (IP filtering and threshold increase eliminated false positives)

**Gaps:**
- Query doesn't distinguish "new threat" vs "known blocked source"
- Cannot identify if blocking is effective (no visibility into firewall drops)
- Missing temporal context for prioritization

## Decision

**Status**: [ ] Accept | [ ] Reject | [x] Needs Changes

**Reasoning**: Query refinements worked well - noise drastically reduced. However, no actionable new threats detected. Need to add temporal logic to focus on emerging attackers vs. re-alerting on known blocked sources.

## Next Actions

- [ ] Add "first seen in 7 days" temporal logic to query
- [ ] Cross-reference results with firewall block list to auto-filter known blocked IPs
- [x] Validated that previous week's blocks are still effective (no successful logins from blocked IPs)
- [ ] Consider reducing hunt frequency to weekly (threat landscape appears stable)

## Lessons Learned

Iterative refinement works - applying lessons from first run successfully eliminated noise. However, **temporal context matters**: distinguishing "new threat" vs "known blocked" is critical for actionable alerts.

Without temporal awareness, this hunt creates alert fatigue by repeatedly flagging already-mitigated threats.

**For next run:**
- Add to query: `| where NOT [blocked_ip_lookup]` to exclude known blocked sources
- Add temporal filter: only flag IPs first seen in past 7 days
- Consider adding "successful login after failures" as secondary indicator for credential stuffing

**Detection Engineering Recommendation:**
Ready to convert to automated detection with these modifications. Weekly cadence appears sufficient based on threat landscape stability.

---

**Related Tickets**: DE-3041 (detection rule draft ready), SOC-2847 (original alert - can close)
**Related Hunts**: None yet - consider H-0002 for "successful login after brute force" follow-up
